# üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–µ–ø–ª–æ—è strain-collection

## –û–±–∑–æ—Ä

–ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–µ–ø–ª–æ—è –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä `4feb` (https://culturedb.elcity.ru).

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### üéØ –ü–æ–ª–Ω—ã–π –¥–µ–ø–ª–æ–π –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω
```bash
make deploy-prod
```
**–í—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º —Ä–µ–∂–∏–º–µ:**
1. –°–æ–±–∏—Ä–∞–µ—Ç React frontend (`npm run build`)
2. –°–æ–±–∏—Ä–∞–µ—Ç Docker –æ–±—Ä–∞–∑—ã –±–µ–∑ –∫—ç—à–∞
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞–∑—ã –≤ Docker Hub
4. –û–±–Ω–æ–≤–ª—è–µ—Ç –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä
5. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
make status-prod

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
make logs-prod                    # –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã, 50 —Å—Ç—Ä–æ–∫
make logs-prod backend 100        # Backend, 100 —Å—Ç—Ä–æ–∫  
make logs-prod frontend 20        # Frontend, 20 —Å—Ç—Ä–æ–∫
make logs-prod db 30              # Database, 30 —Å—Ç—Ä–æ–∫
```

### üóÑÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π (–≤—Ö–æ–¥–∏—Ç –≤ deploy-prod)
make migrate-prod

# –î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
./scripts/migrate_production.sh check    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
./scripts/migrate_production.sh apply    # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
./scripts/migrate_production.sh show     # –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
```

### üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–µ–ø–ª–æ—è (–æ—Ç–¥–µ–ª—å–Ω—ã–µ —ç—Ç–∞–ø—ã)
```bash
make build-images     # –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–æ–≤
make push-images      # –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Docker Hub
make update-remote    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

```
strain_collection_new/
‚îú‚îÄ‚îÄ deployment/Makefile                # –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ (–∑–∞–ø—É—Å–∫–∞—Ç—å –∏–∑ –ø–∞–ø–∫–∏ deployment)
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ update_remote_server.sh       # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–∞ (–≤–∫–ª—é—á–∞–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏)
‚îÇ   ‚îú‚îÄ‚îÄ check_production_status.sh    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ logs_production.sh            # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ migrate_production.sh         # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ Django
‚îî‚îÄ‚îÄ README_DEPLOY.md                   # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –ü—Ä–æ—Ü–µ—Å—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è

### 1. –°–±–æ—Ä–∫–∞ frontend
- –ö–æ–º–ø–∏–ª—è—Ü–∏—è TypeScript
- –°–±–æ—Ä–∫–∞ React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å Vite
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω

### 2. –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–æ–≤
```bash
# Backend –æ–±—Ä–∞–∑
docker build --no-cache -t gimmyhat/strain-collection-backend:latest backend/

# Frontend –æ–±—Ä–∞–∑  
docker build --no-cache -t gimmyhat/strain-collection-frontend:latest frontend/
```

### 3. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Docker Hub
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Docker Hub
- Push backend –∏ frontend –æ–±—Ä–∞–∑–æ–≤
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –æ–±—Ä–∞–∑–æ–≤

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–∞
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É `4feb` –ø–æ SSH
- –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
- –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤—ã—Ö –æ–±—Ä–∞–∑–æ–≤
- –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –æ–±—Ä–∞–∑–æ–≤
- –ó–∞–ø—É—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π Django**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ health checks

## CI/CD —á–µ—Ä–µ–∑ GitHub Actions

- –¢—Ä–∏–≥–≥–µ—Ä: —Ç–æ–ª—å–∫–æ —Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ (`workflow_dispatch`). –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –Ω–∞ `push` –æ—Ç–∫–ª—é—á—ë–Ω.
- –°–±–æ—Ä–∫–∞ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è –æ–±—Ä–∞–∑–æ–≤ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞–º–∏ –∏–∑ `deployment/Makefile`:
  - `cd deployment && make build-images`
  - `cd deployment && make push-images`
- –ó–∞–ø—É—Å–∫ –¥–µ–ø–ª–æ—è –∏–∑ CLI: `cd deployment && make deploy-gh` (—Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `gh` –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: `gh auth login`).
 - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∏ –ª–æ–≥–æ–≤ –∏–∑ CLI:
   - –°—Ç–∞—Ç—É—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—É—Å–∫–∞: `cd deployment && make deploy-gh-status`
   - –õ–æ–≥–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—É—Å–∫–∞: `cd deployment && make deploy-gh-logs`
   - –°—Ç—Ä–∏–º–∏–Ω–≥ –ª–æ–≥–æ–≤ –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è: `cd deployment && make deploy-gh-watch`

### ‚ÑπÔ∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ–± –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ gh/GH_TOKEN
- –í—Å–µ —Ü–µ–ª–∏ `deploy-gh*` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
  - –õ–æ–∫–∞–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è `gh` —á–µ—Ä–µ–∑ `gh auth login` (GitHub.com ‚Üí HTTPS).
  - –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `GH_TOKEN` —Å –ø—Ä–∞–≤–∞–º–∏ `repo` –∏ `workflow`.
- –ï—Å–ª–∏ `GH_TOKEN` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, Makefile –ø–µ—Ä–µ–¥–∞—ë—Ç –µ–≥–æ –Ω–∞–ø—Ä—è–º—É—é –≤ –∫–æ–º–∞–Ω–¥—ã `gh` –¥–ª—è –Ω–µ–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞.
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ–∫–µ–Ω–∞: `set GH_TOKEN=YOUR_TOKEN` (PowerShell) –∏–ª–∏ `export GH_TOKEN=YOUR_TOKEN` (bash).
- SSH –∫–ª—é—á –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π –æ–∫–æ–Ω—á–∞–Ω–∏–π —Å—Ç—Ä–æ–∫ (CRLF ‚Üí LF), –∑–∞—Ç–µ–º –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –∞–ª–∏–∞—Å `4feb`.
- –î–µ–ø–ª–æ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º `scripts/update_remote_server.sh` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏–∑ —Å–µ–∫—Ä–µ—Ç–æ–≤.
- –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è HTTP health-check.

#### –§–∞–π–ª `.github/gh.env` (–∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–∫–µ–Ω–∞)
- Makefile –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ç–æ–∫–µ–Ω –∏–∑ —Ñ–∞–π–ª–∞ `.github/gh.env` –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å `gh auth login --with-token`, –µ—Å–ª–∏ `gh` –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω.
- –û–∂–∏–¥–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç: –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ `GH_TOKEN=ghp_XXXXXXXX...`.
- –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ: –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–∞—Ç–∞–ª–æ–≥–∞ `deployment` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—É—Ç—å `../.github/gh.env`.
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: —ç—Ç–æ—Ç —Ñ–∞–π–ª –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–º (–Ω–µ —Ö—Ä–∞–Ω–∏—Ç—å –≤ VCS). –î–ª—è CI –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.

–¢—Ä–µ–±—É–µ–º—ã–µ —Å–µ–∫—Ä–µ—Ç—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:
- `DOCKERHUB_USERNAME`, `DOCKERHUB_TOKEN` ‚Äî –¥–æ—Å—Ç—É–ø –∫ Docker Hub
- `PROD_SSH_KEY` ‚Äî –ø—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á (—Ñ–æ—Ä–º–∞—Ç LF; –≤ workflow CRLF –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- `PROD_SSH_HOST`, `PROD_SSH_USER`, `PROD_SSH_PORT` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã SSH-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- `PROD_SSH_KNOWN_HOSTS` ‚Äî —Å—Ç—Ä–æ–∫–∞ known_hosts –¥–ª—è –ø—Ä–æ–¥-—Å–µ—Ä–≤–µ—Ä–∞
- `PROD_REMOTE_DIR` ‚Äî –∫–∞—Ç–∞–ª–æ–≥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `~/strain_ultra_minimal`)
- `PROD_HEALTHCHECK_URL` ‚Äî URL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è API

–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é:
- –í–∫–ª–∞–¥–∫–∞ `Actions` ‚Üí `Deploy to Production` ‚Üí `Run workflow`.
- –ò–∑ CLI: `cd deployment && make deploy-gh`.
 - –°—Ç–∞—Ç—É—Å/–ª–æ–≥–∏: `cd deployment && make deploy-gh-status` / `make deploy-gh-logs` / `make deploy-gh-watch`.

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ (`make status-prod`)
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
- üìä –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- üíæ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU –∏ –ø–∞–º—è—Ç–∏
- üíø –°–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ
- üìù –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö
- üåê –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API –∏ Frontend

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ (`make logs-prod`)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—ã–±–æ—Ä–∞ —Å–µ—Ä–≤–∏—Å–∞ (backend/frontend/db/all)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û–±—ã—á–Ω—ã–π workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é (–≤–∫–ª—é—á–∞–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏)
make deploy-prod

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
make status-prod

# –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ - –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
make logs-prod backend 50

# –ï—Å–ª–∏ –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ –º–∏–≥—Ä–∞—Ü–∏–∏ (–±–µ–∑ –ø–æ–ª–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è)
make migrate-prod
```

### –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
make status-prod

# –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
make logs-prod backend 100
make logs-prod frontend 50
```

### –ß–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
```bash
# –¢–æ–ª—å–∫–æ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤
cd deployment && make build-images

# –¢–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ (–±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏)
cd deployment && make update-remote
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –õ–æ–∫–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞
- Docker –∏ docker-compose
- Node.js –∏ npm (–¥–ª—è —Å–±–æ—Ä–∫–∏ frontend)
- SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É `4feb`
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Docker Hub (`docker login`)

### –ü—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π SSH –∫–ª—é—á –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–∞–∫ `4feb`
- Docker –∏ docker-compose –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –†–∞–±–æ—á–∏–π –∫–∞—Ç–∞–ª–æ–≥ `~/strain_ultra_minimal`

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π `.env` —Ñ–∞–π–ª–æ–≤
- Graceful shutdown —Å–µ—Ä–≤–∏—Å–æ–≤ –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- Health checks –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
- –û—Ç–∫–∞—Ç –≤–æ–∑–º–æ–∂–µ–Ω —á–µ—Ä–µ–∑ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
ssh 4feb

# –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh 4feb 'cd ~/strain_ultra_minimal && docker compose ps'
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –æ–±—Ä–∞–∑–∞–º–∏
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –æ–±—Ä–∞–∑–æ–≤
docker images | grep strain-collection

# –†—É—á–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞
docker build --no-cache -t gimmyhat/strain-collection-frontend:latest frontend/
```

### –ü—Ä–æ–±–ª–µ–º—ã –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–µ
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
ssh 4feb 'cd ~/strain_ultra_minimal && docker compose logs -f'

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
ssh 4feb 'cd ~/strain_ultra_minimal && docker compose restart'
```

## –†–∞–±–æ—Ç–∞ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏
–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ `make deploy-prod` –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å –Ω–æ–≤—ã–º–∏ –æ–±—Ä–∞–∑–∞–º–∏
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π (`showmigrations`)
3. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã –Ω–µ–ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ - –æ–Ω–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
4. –ü—Ä–æ—Ü–µ—Å—Å –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –≤—ã–≤–æ–¥–µ

### –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
```bash
# –ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
cd deployment && make migrate-prod

# –î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
./scripts/migrate_production.sh check     # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
./scripts/migrate_production.sh apply     # –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Å backup'–æ–º –ë–î
./scripts/migrate_production.sh show      # –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
./scripts/migrate_production.sh rollback  # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ç–∫–∞—Ç–µ
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –º–∏–≥—Ä–∞—Ü–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ backup'–∞ –ë–î –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –º–∏–≥—Ä–∞—Ü–∏–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—Ç–∫–∞—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–π (—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)

### Troubleshooting –º–∏–≥—Ä–∞—Ü–∏–π
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –º–∏–≥—Ä–∞—Ü–∏–π
ssh 4feb 'cd ~/strain_ultra_minimal && docker compose exec backend python manage.py showmigrations'

# –†—É—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏
ssh 4feb 'cd ~/strain_ultra_minimal && docker compose exec backend python manage.py migrate app_name migration_number'

# –ü—Ä–æ—Å–º–æ—Ç—Ä SQL –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ (–±–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è)
ssh 4feb 'cd ~/strain_ultra_minimal && docker compose exec backend python manage.py sqlmigrate app_name migration_number'
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:
- **Frontend**: https://culturedb.elcity.ru
- **API**: https://culturedb.elcity.ru/api/
- **Health Check**: https://culturedb.elcity.ru/api/health/

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `make status-prod` –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã.